<!DOCTYPE html>
<html>
  <head>
    <title>KitaplarÄ±m</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width , initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      body {
        margin: 0;
        padding: 0;
        height: 100vh;
        background-image: url("static/background.png");
        background-size: cover;
        background-position: center;
        display: flex;
        flex-direction: column;
        gap: 20px;
        justify-content: center;
        align-items: center;
        font-family: "Poppins", sans-serif;
      }

      h1 {
        color: #987654;
        margin-bottom: 50px;
        font-size: 45px;
      }

      .button {
        background-color: #987654;
        color: #333;
        border: none;
        padding: 10px 30px;
        font-size: 20px;
        font-weight: bold;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 220px;
        align-self: center;
      }
      .button:hover {
        background-color: #4caf50;
        /* color: white; */
        transform: scale(1.05);
      }
      a {
        display: block;
        margin-top: 10px;
        color: wheat;
        text-decoration: none;
      }

      a:hover {
        color: #4caf50;
      }
    </style>
  </head>
  <body class="bg-gray-100 p-6">
    <div class="max-w-6xl mx-auto mt-10 bg-white shadow-lg rounded-xl p-6">
      {% if mode == 'iade' %}
      <h1 class="text-2xl font-bold mb-4 text-center text-blue-700">Ä°ade</h1>
      {% else %}
      <h1 class="text-2xl font-bold mb-4 text-center text-blue-700">
        ðŸ“š Ã–dÃ¼nÃ§ AlÄ±nan Kitaplar
      </h1>
      {%endif %} {% with messages = get_flashed_messages(with_categories=true)
      %} {% if messages %} {% for category, message in messages %}
      <div
        class="p-3 mb-3 rounded-lg text-white {% if category == 'success' %}bg-green-500 {% elif category == 'warning' %}bg-yellow-500 {% elif category == 'danger' %}bg-red-500 {% else %}bg-blue-500{% endif %}"
      >
        {{ message }}
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <table class="w-full border border-gray-300 rounded-lg overflow-hidden">
        <thead class="bg-blue-100">
          <tr>
            <th class="px-4 py-2 text-left">KullanÄ±cÄ±</th>
            <th class="px-4 py-2 text-left">Kitap</th>
            <th class="px-4 py-2 text-left">AlÄ±ÅŸ Tarihi</th>
            <th class="px-4 py-2 text-left">Ä°ade Tarihi</th>
            <th class="px-4 py-2 text-left">Durum</th>
            <th class="px-4 py-2 text-left">Ceza (â‚º)</th>
            {% if mode == 'iade' %}
            <th class="px-4 py-2 text-center">Ä°ÅŸlem</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for odunc in oduncler %}
          <tr class="border-t hover:bg-gray-50">
            <td class="px-4 py-2">
              {{ odunc["user"] if odunc.get("user") else "Bilinmiyor" }}
            </td>

            <td class="px-4 py-2">{{ odunc["kitap"] }}</td>

            <td class="px-4 py-2">{{ odunc["alis_tarihi"] }}</td>

            <td class="p-2">
              {% if odunc["gercek_iade_tarihi"] %} {{
              odunc["gercek_iade_tarihi"] }} {% else %} {{ odunc["iade_tarihi"]
              }} {% endif %}
            </td>
            <td class="px-4 py-2">
              {% if odunc["durum"] == 'beklemede' %}
              <span class="text-yellow-600 font-semibold">Beklemede</span>
              {% elif odunc["durum"] == 'onaylandÄ±' %}
              <span class="text-green-600 font-semibold">OnaylandÄ±</span>
              {% elif odunc["durum"] == 'reddedildi' %}
              <span class="text-red-600 font-semibold">Reddedildi</span>
              {% elif odunc["durum"] == 'iade_edildi' %}
              <span class="text-gray-600 font-semibold">Ä°ade Edildi</span>
              {% endif %}
            </td>

            <td class="px-4 py-2">{{ odunc.get("ceza", 0) }}</td>

            {% if mode == 'iade' %}
            <td class="px-4 py-2 text-center">
              {% if odunc.durum == 'onaylandÄ±' %}
              <form
                action="{{ url_for('borrow_bp.iade_al', odunc_id=odunc['id']) }}"
                method="post"
              >
                <button
                  type="submit"
                  class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                >
                  Ä°ade Al
                </button>
              </form>
              {% else %} - {% endif %}
            </td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <a href="personel_panel">Geri DÃ¶n</a>

    <script>
      setTimeout(() => {
        const flash = document.getElementById("flash-message");
        if (flash) {
          flash.style.transition = "opacity 0.5s ease";
          flash.style.opacity = 0;
          setTimeout(() => flash.remove(), 200);
        }
      }, 2000);
    </script>
  </body>
</html>
